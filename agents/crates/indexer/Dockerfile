FROM rust:1.79

WORKDIR /usr/src/indexer

COPY . .

RUN cargo install --path crates/indexer

ENV OTIM_SYSLOG_IDENTIFIER=$OTIM_SYSLOG_IDENTIFIER
ENV OTIM_DOCUMENTDB_URL=$OTIM_DOCUMENTDB_URL
ENV OTIM_RPC_URL=$OTIM_RPC_URL
ENV OTIM_FIBONACCI_ADDRESS=$OTIM_FIBONACCI_ADDRESS
ENV OTIM_POLL_INTERVAL=$OTIM_POLL_INTERVAL

ENTRYPOINT RUST_LOG=indexer=trace indexer 2>&1 >/dev/null
